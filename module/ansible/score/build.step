#!/usr/bin/env bash

blackbox.module.ansible.score.build() {
  typeset question_id=$1

  if ( blackbox.flag.enabled DEBUG_MODE ); then
    printf "\n"
    printf "\033[0;37m%s < BLACKBOX_FLAG__STEP_BUILD=%s %s\033[0m\n" "${FUNCNAME[0]}" "$BLACKBOX_FLAG__STEP_BUILD" "$question_id"
    printf "\033[0;34m[BUILD]\033[0m\n"
  else
    printf "\n"
    printf "[BUILD]\n"
  fi

  local -a ansible_playbook_flags=()

  if ( blackbox.flag.enabled DEBUG_MODE ); then
    ansible_playbook_flags+=("-v")
  fi

  ansible-playbook "${ansible_playbook_flags[@]}" "/home/${BLACKBOX_HOST_USERNAME}/${question_id}/playbook.yml"
}; blackbox.module.ansible.score.build "$@"
